#!/usr/bin/env node

const Cass          = require('./cass')
const {getArgs}     = require('./cass/util/args')
const {MatchAny}    = require('./cass/util/matchers')
const {par_foreach} = require('./cass/util/async')

async function main() {
  const patterns = getArgs({min: 1, usage: 'PATTERN...+'})
  const matcher  = new MatchAny(patterns, 'i')
  const canvas   = new Cass().canvas()
  const modules  = await canvas.getModules()

  return par_foreach(modules, mod =>
    matcher.test(mod.name)
    && canvas.deleteModule(mod.id, {name: mod.name}))
}

main().then(_ => 0, console.log)
