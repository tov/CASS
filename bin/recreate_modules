#!/bin/sh
# vim: ts=4 :

# Deletes and recreates Canvas modules based on Panopto sessions
# and modules.json
#
# Usage: recreate_modules [-vF] SESSION ...+
#
# Options:
#
#   -v      verbose
#   -F      don't fetch panopto sessions

. "$(dirname "$0")/.CASS"
eval "$(getargs -vF ...)"

if [ -z "$flag_F" ]; then
    echo Fetching Panopto sessions...
    records=$("$COURSE_BIN"/fetch_panopto_sessions -v | wc -l | tr -dC 0-9)
    echo "  (retrieved $records session records)"
fi

echo Deleting Canvas modules...
"$COURSE_BIN"/delete_modules $flag_v "$@"

echo Creating Canvas modules...
"$COURSE_BIN"/create_modules $flag_v "$@"
